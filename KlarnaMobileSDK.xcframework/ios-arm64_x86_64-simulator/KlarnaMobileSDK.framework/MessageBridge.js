function $737874114c2a80d9$export$2996f80ef42b8419(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function $4a1bdc4745d43223$var$_defineProperties(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $4a1bdc4745d43223$export$d60067ff2358eee8(e,a,t){return a&&$4a1bdc4745d43223$var$_defineProperties(e.prototype,a),t&&$4a1bdc4745d43223$var$_defineProperties(e,t),e}var $b4efb1694e6b9d0a$export$a96b0bbdbd70b734,$dc2b35112bcce9e2$export$243e62d78d3b544d,$54e9de874e7cf259$export$468fbe6771f1699e=function e(a,t,r,o){$737874114c2a80d9$export$2996f80ef42b8419(this,e),this.action=a,this.receiverName=t,this.message=r,this.bridgeData=o},$e27faf65630ebc9a$export$e12b769011d096b4=function e(a,t,r){$737874114c2a80d9$export$2996f80ef42b8419(this,e),this.bridgeVersion=a,this.endpoints={analytics:t,deviceInfo:r}},$f12b5d7f8ad4b8dc$export$33b0bc6879c27206=function e(a,t){$737874114c2a80d9$export$2996f80ef42b8419(this,e),this.staging=a,this.production=t},$a527415fb53b3e91$export$eed022e50baffed5={Analytics:{Staging:"evt-eu.staging.eu1.yaco.klarna.net",Production:"not-reallly-evt.klarna.com"},DeviceData:{Staging:"devicedata-staging.klarna",Production:"devicedata-production.klarna"}};function $2f00b6da4f93a1b0$export$79e617b1955a2616(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,r=new Array(a);t<a;t++)r[t]=e[t];return r}function $0b12187bee7eb4a2$export$7e0947b5ad3404e2(e){if(Array.isArray(e))return $2f00b6da4f93a1b0$export$79e617b1955a2616(e)}function $8c4943bc829187c5$export$1eb58a6e75231000(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function $baed4c0776cd3286$export$e6f3c4780d19eb2b(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $221747f12d572dcb$export$a5be06335b3a083c(e,a){var t;if(e)return"string"==typeof e?$2f00b6da4f93a1b0$export$79e617b1955a2616(e,a):"Map"===(t="Object"===(t=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?$2f00b6da4f93a1b0$export$79e617b1955a2616(e,a):void 0}function $7850346231e6ed7d$export$1b5e630bc3aea29f(e){return $0b12187bee7eb4a2$export$7e0947b5ad3404e2(e)||$8c4943bc829187c5$export$1eb58a6e75231000(e)||$221747f12d572dcb$export$a5be06335b3a083c(e)||$baed4c0776cd3286$export$e6f3c4780d19eb2b()}!function(e){e.ReceiverAdded="ReceiverAdded",e.ReceiverRemoved="ReceiverRemoved",e.MessagePosted="MessagePosted",e.EndpointsReported="EndpointsReported",e.MessageBridgeWillStart="MessageBridgeWillStart",e.MessageBridgeAlreadyRunning="MessageBridgeAlreadyRunning"}($b4efb1694e6b9d0a$export$a96b0bbdbd70b734=$b4efb1694e6b9d0a$export$a96b0bbdbd70b734||{}),function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.None=4]="None"}($dc2b35112bcce9e2$export$243e62d78d3b544d=$dc2b35112bcce9e2$export$243e62d78d3b544d||{});var $3e97667694aebf08$export$9d82dedbeb797f41,$fa9011cb1dfb6667$export$caf75cbffb0ca40,$ec5a25b0ccdbabd5$export$d6ff711ee8724594,$39d6456d60f7b2a5$export$c8a7d7e37b742a82,$dc2b35112bcce9e2$export$efa9a398d6368992=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e),this.level=4,this.delegate=null}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"debug",value:function(){for(var e,a=arguments.length,t=new Array(a),r=0;r<a;r++)t[r]=arguments[r];try{0===this.level&&(null!=this.delegate&&this.delegate.logDebug(this._stringifyParams(t)),(e=console).log.apply(e,$7850346231e6ed7d$export$1b5e630bc3aea29f(t)))}catch(e){}}},{key:"info",value:function(){for(var e,a=arguments.length,t=new Array(a),r=0;r<a;r++)t[r]=arguments[r];try{this.level<=1&&(null!=this.delegate&&this.delegate.logDebug(this._stringifyParams(t)),(e=console).info.apply(e,$7850346231e6ed7d$export$1b5e630bc3aea29f(t)))}catch(e){}}},{key:"warn",value:function(){for(var e,a=arguments.length,t=new Array(a),r=0;r<a;r++)t[r]=arguments[r];try{this.level<=2&&(null!=this.delegate&&this.delegate.logDebug(this._stringifyParams(t)),(e=console).warn.apply(e,$7850346231e6ed7d$export$1b5e630bc3aea29f(t)))}catch(e){}}},{key:"error",value:function(){for(var e,a=arguments.length,t=new Array(a),r=0;r<a;r++)t[r]=arguments[r];try{this.level<=3&&(null!=this.delegate&&this.delegate.logError(this._stringifyParams(t)),(e=console).error.apply(e,$7850346231e6ed7d$export$1b5e630bc3aea29f(t)))}catch(e){}}},{key:"_stringifyParams",value:function(e){try{return JSON.stringify(e,null,2)}catch(e){return"Couldn't stringify logging params."}}}]),e}(),$86c5e230eba4f632$export$d2ca453b913dcdea=($dc2b35112bcce9e2$export$efa9a398d6368992.default=new $dc2b35112bcce9e2$export$efa9a398d6368992,function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,null,[{key:"getHandshakeResponseParams",value:function(e,a){return e.handshakeResponseParamsMap[a]}},{key:"compareVersion",value:function(e,a){for(var t=e.split("-")[0].replace("v","").split(".").map(function(e){e=parseInt(e,10);return isNaN(e)?0:e});t.length<3;)t.push(0);for(var r=a.split("-")[0].replace("v","").split(".").map(function(e){e=parseInt(e,10);return isNaN(e)?0:e});r.length<3;)r.push(0);return t[0]>r[0]?1:t[0]<r[0]?-1:t[1]>r[1]?1:t[1]<r[1]?-1:t[2]>r[2]?1:t[2]<r[2]?-1:0}},{key:"createUUIDv4",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var a=16*Math.random()|0;return("x"==e?a:3&a|8).toString(16)})}},{key:"replaceBridge",value:function(e,t){$dc2b35112bcce9e2$export$efa9a398d6368992.default.info("Replacing old bridge",e);var a=e.receivers,r=e.queuedMessages,o=e.eventListeners,s=e.handshakeResponseParamsMap,d=e.queuedKlarnaPaymentsMessages;if(t.notifyEvent({name:"WillReplaceNativeHook",payload:{oldMessageBridgeVersion:e.version,newMessageBridgeVersion:t.version,receivers:a.toString(),queuedMessages:r.toString(),nativeReady:e.nativeReady.toString()}}),(window.__KlarnaNativeHook=t).notifyEvent({name:"ReplacedNativeHook",payload:{oldMessageBridgeVersion:e.version,newMessageBridgeVersion:t.version}}),e.destroy&&e.destroy(),null!=o&&o.forEach(function(e){return t.addEventListener(e)}),null!=s)if(s.forEach)s.forEach(function(e,a){t.handshakeResponseParamsMap[a]=e});else for(var n in s)t.handshakeResponseParamsMap[n]=s[n];r.forEach(function(e){return t.queuedMessages.push(e)}),a.forEach(function(e){return t.addReceiver(e.name,e.callback)}),void 0!==d&&d.forEach(function(e){return t.queuedKlarnaPaymentsMessages.push(e)}),e.nativeReady&&t.setNativeReady(),$dc2b35112bcce9e2$export$efa9a398d6368992.default.info("Replaced old bridge",t)}}]),e}()),$e46f7c82eed16cd3$export$5e8778959ee066ba="klarna-base-64-utf8::",$e46f7c82eed16cd3$export$3ab5d4b363e83ecc="v1.4.4-239b325f87c",$ab11a08eff1af618$export$3b418aac0e066580=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"overrideDefaults",value:function(){var t,e;null!=window.defaultAtob&&null!=window.sdkAtob?$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("Already installed custom atob(). Skipping."):(t=window.atob,window.atob=e=function(e){return 0===e.indexOf($e46f7c82eed16cd3$export$5e8778959ee066ba)?function(a){try{return decodeURIComponent(atob(a).split("").map(function(e){return null==(e=e.charCodeAt(0).toString(16).match(/.{1,2}/g))?void 0:e.map(function(e){return"%"+("00"+e).slice(-2)}).join("")}).join(""))}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("atob-custom",{"src-string":a,msg:e.toString()});try{return t(a)}catch(e){throw $dc2b35112bcce9e2$export$efa9a398d6368992.default.error("atob-default",{"src-string":a,msg:e.toString()}),e}}}(e.substr($e46f7c82eed16cd3$export$5e8778959ee066ba.length)):t(e)},window.defaultAtob=t,window.sdkAtob=e)}}]),e}(),$057585bf838d51b0$export$9b0bca74892433ef=(!function(e){e.fullscreenReplaceWebView="fullscreenReplaceWebView",e.fullscreenMoveWebView="fullscreenMoveWebView",e.fullscreenReplaceOverlay="fullscreenReplaceOverlay",e.fullscreenRestoreWebView="fullscreenRestoreWebView",e.handshakeResponse="handshakeResponse",e.actionToComponent="actionToComponent"}($3e97667694aebf08$export$9d82dedbeb797f41=$3e97667694aebf08$export$9d82dedbeb797f41||{}),[$3e97667694aebf08$export$9d82dedbeb797f41.fullscreenReplaceWebView,$3e97667694aebf08$export$9d82dedbeb797f41.fullscreenMoveWebView,$3e97667694aebf08$export$9d82dedbeb797f41.fullscreenReplaceOverlay,$3e97667694aebf08$export$9d82dedbeb797f41.fullscreenRestoreWebView]),$f5914d5fa710f736$export$544cf229e56c299f=[{merchantAppName:"boohooMAN",osName:"iOS"},{merchantAppName:"Nasty Gal",osName:"iOS"},{merchantAppName:"MISSPAP",osName:"iOS"},{merchantAppName:"boohoo",osName:"iOS"},{merchantAppName:"PLT UAT",osName:"iOS"}],$c3ff21775b3c8166$export$ea3d1b96f570ebdd=(!function(e){e.Root="Root",e.Frame="Frame"}($fa9011cb1dfb6667$export$caf75cbffb0ca40=$fa9011cb1dfb6667$export$caf75cbffb0ca40||{}),!function(e){e.RegisterWindow="RegisterWindow",e.PostReceiverMessage="PostReceiverMessage",e.PostNativeMessage="PostNativeMessage",e.IsNativeReadyRequest="IsNativeReadyRequest",e.IsNativeReadyResponse="IsNativeReadyResponse",e.IsSdkWebViewRequest="IsSdkWebViewRequest",e.IsSdkWebViewResponse="IsSdkWebViewResponse"}($ec5a25b0ccdbabd5$export$d6ff711ee8724594=$ec5a25b0ccdbabd5$export$d6ff711ee8724594||{}),function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"handleMessage",value:function(a,t,r){try{var e;if(r.action===$ec5a25b0ccdbabd5$export$d6ff711ee8724594.PostNativeMessage)return a.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Root?(e=r.data,t.messageController.postEventMessageToNative(t,e),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("Relayed Native Message")):$dc2b35112bcce9e2$export$efa9a398d6368992.default.warn("Frame Message Bridge received invalid message",r),!0}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("NativeMessageDelegate handle message failed",a,t,r,e)}return!1}}]),e}()),$d4bd0b16daddf41f$export$813991340c5a5201=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"handleMessage",value:function(a,t,r){try{if(r.action===$ec5a25b0ccdbabd5$export$d6ff711ee8724594.PostReceiverMessage){if(a.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Frame){var e=r.data;try{t.postMessage(e,!0)}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("Relayed Receiver Message failed to post message via bridge",r,t)}$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("Relayed Receiver Message to Message Bridge",r,t)}else $dc2b35112bcce9e2$export$efa9a398d6368992.default.warn("Root Message Bridge received invalid message",r);return!0}}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("ReceiverMessageDelegate handle message failed",a,t,r,e)}return!1}}]),e}(),$24815a6cb6024ef5$export$a9cf52565e7ce5db=function e(a){$737874114c2a80d9$export$2996f80ef42b8419(this,e),this.isNativeReady=a},$d1ea647a48aee95f$export$23508ec371339b15=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"handleMessage",value:function(a,t,r){try{var e,o,s;if(r.action===$ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsNativeReadyRequest)return a.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Root?(e=new $24815a6cb6024ef5$export$a9cf52565e7ce5db(t.nativeReady),o=new $3f8d71218c98a45f$export$137d9274eb4bdc8d($ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsNativeReadyResponse,e,r.messageId),a.postMessage(o),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("Processed IsNativeReadyRequest",r,o)):$dc2b35112bcce9e2$export$efa9a398d6368992.default.warn("Frame Message Bridge received invalid message",r),!0;if(r.action===$ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsNativeReadyResponse)return a.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Frame?((s=r.data).isNativeReady&&t.setNativeReady(),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("Processed IsNativeReadyResponseData",r,s,this)):$dc2b35112bcce9e2$export$efa9a398d6368992.default.warn("Root Message Bridge received invalid message",r),!0}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("NativeReadyMessageDelegate handle message failed",a,t,r,e)}return!1}}]),e}(),$976c9715c78f6b69$export$15f24e2438b5a10d=function e(a){$737874114c2a80d9$export$2996f80ef42b8419(this,e),this.isSdkWebView=a},$7fb1a5c018ced9fc$export$85b2f1afd23a3b1c=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"handleMessage",value:function(a,t,r){try{var e,o,s;if(r.action===$ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsSdkWebViewRequest)return a.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Root?(e=new $976c9715c78f6b69$export$15f24e2438b5a10d(t.nativeController.isSdkWebView(t)),o=new $3f8d71218c98a45f$export$137d9274eb4bdc8d($ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsSdkWebViewResponse,e,r.messageId),a.postMessage(o),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("Processed IsSdkWebViewRequest",r,o)):$dc2b35112bcce9e2$export$efa9a398d6368992.default.warn("Frame Message Bridge received invalid message",r),!0;if(r.action===$ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsSdkWebViewResponse)return a.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Frame?(s=r.data,t.nativeController.setIsSdkWebView(s.isSdkWebView),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("Processed IsSdkWebViewResponse",r,s)):$dc2b35112bcce9e2$export$efa9a398d6368992.default.warn("Root Message Bridge received invalid message",r),!0}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("IsSdkWebViewMessageDelegate handle message failed",a,t,r,e)}return!1}}]),e}(),$12d919e3cb0be9dc$export$d011177d13fe20f1=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"handleMessage",value:function(e,a,t){try{var r;if(t.action===$ec5a25b0ccdbabd5$export$d6ff711ee8724594.RegisterWindow)return e.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Root?(r=t.sourceWindowId,e.windows.push(r),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("CrossWindow registered",r)):$dc2b35112bcce9e2$export$efa9a398d6368992.default.warn("Frame Message Bridge received invalid message",t),!0}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("CrossWindow failed to register",t)}return!1}}]),e}(),$e0ffd6e27a79933d$export$8a7b6697b2b3d2e1=function(){function s(){$737874114c2a80d9$export$2996f80ef42b8419(this,s)}return $4a1bdc4745d43223$export$d60067ff2358eee8(s,null,[{key:"postMessageToNestedWindows",value:function(e,a){try{for(var t=a.frames,r=0;r<t.length;r++){var o=t[r];s.postMessageToWindow(e,o);try{this.postMessageToNestedWindows(e,o)}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("CrossWindowMessage post failed to deep nested window")}}}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("CrossWindowMessage post failed to nested window")}}},{key:"postMessageToWindow",value:function(a,e){try{$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("CrossWindowMessage Will Send",a,window.__KlarnaNativeHook);e.postMessage(a,"*"),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("CrossWindowMessage Sent",a,window.__KlarnaNativeHook,"*")}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("CrossWindowMessage Failed to Send",e,a,window.__KlarnaNativeHook)}}}]),s}(),$4056916c3e7cc48b$export$8697e044b6ceac7e=function(){function t(e){var a=this;$737874114c2a80d9$export$2996f80ef42b8419(this,t),this.windows=[],this.delegates=[new $12d919e3cb0be9dc$export$d011177d13fe20f1,new $7fb1a5c018ced9fc$export$85b2f1afd23a3b1c,new $d1ea647a48aee95f$export$23508ec371339b15,new $c3ff21775b3c8166$export$ea3d1b96f570ebdd,new $d4bd0b16daddf41f$export$813991340c5a5201],this.responseCallbacks={},this.listener=function(e){try{a.receivedMessage(e)}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("CrossWindowMessage listener caught exception",e)}},this.windowId=t.getWindowId(),this.messageBridge=e,window.self!==window.top?this.mode=$fa9011cb1dfb6667$export$caf75cbffb0ca40.Frame:this.mode=$fa9011cb1dfb6667$export$caf75cbffb0ca40.Root}return $4a1bdc4745d43223$export$d60067ff2358eee8(t,[{key:"postMessage",value:function(a){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;try{$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("CrossWindowMessage Will Send",a,window.__KlarnaNativeHook),t&&(this.responseCallbacks[a.messageId]=t);var e=a.encode();switch(this.mode){case $fa9011cb1dfb6667$export$caf75cbffb0ca40.Root:$e0ffd6e27a79933d$export$8a7b6697b2b3d2e1.postMessageToNestedWindows(e,window.self);break;case $fa9011cb1dfb6667$export$caf75cbffb0ca40.Frame:$e0ffd6e27a79933d$export$8a7b6697b2b3d2e1.postMessageToWindow(e,window.top)}}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("CrossWindowMessage post has failed",a,t,window.__KlarnaNativeHook,e)}}},{key:"register",value:function(e){var a;this.messageBridge!=e&&(a=this.messageBridge,this.messageBridge=e,$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("CrossWindowController message bridge replaced",e,a)),window.addEventListener("message",this.listener,{once:!1,capture:!1,passive:!1}),this.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Frame&&this.postMessage(new $3f8d71218c98a45f$export$137d9274eb4bdc8d($ec5a25b0ccdbabd5$export$d6ff711ee8724594.RegisterWindow,null)),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("CrossWindowController Registered")}},{key:"unregister",value:function(e){this.messageBridge=null,window.removeEventListener("message",this.listener,{capture:!1}),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("CrossWindowController Un-Registered")}},{key:"receivedMessage",value:function(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("MessageEvent Received",e),e.source===window.self?$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("MessageEvent received from self"):(e=$3f8d71218c98a45f$export$137d9274eb4bdc8d.decode(e.data),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("CrossWindowMessage Received",e,window.__KlarnaNativeHook),this.receivedCrossWindowMessage(e),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("CrossWindowMessage Processed",e,window.__KlarnaNativeHook))}},{key:"receivedCrossWindowMessage",value:function(e){if(this.validateCrossWindowMessage(e)){var a=this.messageBridge;if(null==a)$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("CrossWindowController null message bridge");else{var t=!0,r=!1,o=void 0;if(!this.callResponseCallback(e)){try{for(var s,d=this.delegates[Symbol.iterator]();!(t=(s=d.next()).done);t=!0)if(s.value.handleMessage(this,a,e))return}catch(e){r=!0,o=e}finally{try{t||null==d.return||d.return()}finally{if(r)throw o}}$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("CrossWindowController message could not be handled",this,a,e)}}}else $dc2b35112bcce9e2$export$efa9a398d6368992.default.error("CrossWindowController received invalid message",e)}},{key:"validateCrossWindowMessage",value:function(e){return null!=e.messageId&&null!=e.messageId&&0<e.messageId.length&&null!=e.action&&0<e.action.length}},{key:"callResponseCallback",value:function(e){var a=this.responseCallbacks[e.messageId];return!!a&&a(e)}}],[{key:"getWindowId",value:function(){var e=window.__KlarnaNativeHookWindowId;return e||(e=$86c5e230eba4f632$export$d2ca453b913dcdea.createUUIDv4(),window.__KlarnaNativeHookWindowId=e)}}]),t}(),$3f8d71218c98a45f$export$137d9274eb4bdc8d=function(){function s(e,a){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:$86c5e230eba4f632$export$d2ca453b913dcdea.createUUIDv4(),r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:window.origin,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:$4056916c3e7cc48b$export$8697e044b6ceac7e.getWindowId();$737874114c2a80d9$export$2996f80ef42b8419(this,s),this.messageId=t,this.sourceWindowId=o,this.sourceOrigin=r,this.action=e,this.data=a}return $4a1bdc4745d43223$export$d60067ff2358eee8(s,[{key:"encode",value:function(){return JSON.stringify(this)}}],[{key:"decode",value:function(e){return JSON.parse(e)}}]),s}(),$85771519b3f11699$export$15f59c3f623e5e81=function(){function t(){$737874114c2a80d9$export$2996f80ef42b8419(this,t),this.delayedMessages=[],this.sendDelayedMessagesWithInterval()}return $4a1bdc4745d43223$export$d60067ff2358eee8(t,[{key:"sendMessage",value:function(e,a){e.nativeReady?t.shouldDelayMessage(e,a)?this.delayedMessages.push(new $85771519b3f11699$var$MessageBridgeNativeHookMessage(e,a)):this.postEventMessageToNative(e,t.createBridgeMessage(a)):e.queuedMessages.push(a)}},{key:"postEventMessageToNative",value:function(e,a){e.crossWindowController.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Frame?e.crossWindowController.postMessage(new $3f8d71218c98a45f$export$137d9274eb4bdc8d($ec5a25b0ccdbabd5$export$d6ff711ee8724594.PostNativeMessage,a)):null!=(e=e.nativeController.getNativeMessageHandler())&&(e.postMessage(JSON.stringify(a)),$dc2b35112bcce9e2$export$efa9a398d6368992.default.info("Native Notified for Message",a,e))}},{key:"sendDelayedMessagesWithInterval",value:function(){var a=this;window.setInterval(function(){var e=a.delayedMessages.shift();null!=e&&null!=e.message&&a.postEventMessageToNative(e.messageBridge,t.createBridgeMessage(e.message))},200)}}],[{key:"createBridgeMessage",value:function(e){return new $54e9de874e7cf259$export$468fbe6771f1699e($b4efb1694e6b9d0a$export$a96b0bbdbd70b734.MessagePosted,null,e,null)}},{key:"shouldDelayMessage",value:function(a,t){if(-1!==$057585bf838d51b0$export$9b0bca74892433ef.indexOf(t.action)){a=$86c5e230eba4f632$export$d2ca453b913dcdea.getHandshakeResponseParams(a,t.sender);if(a){var e=a.osName,r=a.merchantAppName,o=!0,t=!1,a=void 0;try{for(var s,d=$f5914d5fa710f736$export$544cf229e56c299f[Symbol.iterator]();!(o=(s=d.next()).done);o=!0){var n=s.value;if(e===n.osName&&r===n.merchantAppName)return!0}}catch(e){t=!0,a=e}finally{try{o||null==d.return||d.return()}finally{if(t)throw a}}}}return!1}}]),t}(),$85771519b3f11699$var$MessageBridgeNativeHookMessage=function e(a,t){$737874114c2a80d9$export$2996f80ef42b8419(this,e),this.messageBridge=a,this.message=t},$9524e81dfe28183b$export$2cdde459a873087f=(!function(e){e.KlarnaPayments="KlarnaPayments",e.KlarnaPaymentsWrapper="KlarnaPaymentsWrapper"}($39d6456d60f7b2a5$export$c8a7d7e37b742a82=$39d6456d60f7b2a5$export$c8a7d7e37b742a82||{}),function(){function i(){$737874114c2a80d9$export$2996f80ef42b8419(this,i)}return $4a1bdc4745d43223$export$d60067ff2358eee8(i,[{key:"releaseQueuedMessagesIfReady",value:function(e,a){if("Native"===a.sender&&a.receiver===$39d6456d60f7b2a5$export$c8a7d7e37b742a82.KlarnaPayments&&a.action===$3e97667694aebf08$export$9d82dedbeb797f41.handshakeResponse&&i.isKlarnaPaymentsReady(e)&&0<e.queuedKlarnaPaymentsMessages.length){$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("KlarnaPayments received handshake response, de-queuing messages.");var t=!0,a=!1,r=void 0;try{for(var o,s=e.queuedKlarnaPaymentsMessages[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var d=o.value;this.sendMessage(e,d),$dc2b35112bcce9e2$export$efa9a398d6368992.default.info("Message De-queued",d)}}catch(e){a=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(a)throw r}}return e.queuedKlarnaPaymentsMessages=[],!0}return!1}},{key:"sendMessage",value:function(e,a){if(!i.queueMessageIfNeeded(e,a)){var t=!0,r=!1,o=void 0;try{for(var s,d=e.receivers[Symbol.iterator]();!(t=(s=d.next()).done);t=!0){var n=s.value;n.name!==a.receiver&&"*"!==a.receiver||(n.callback(a),$dc2b35112bcce9e2$export$efa9a398d6368992.default.info("Receiver Notified for Message",a,n))}}catch(e){r=!0,o=e}finally{try{t||null==d.return||d.return()}finally{if(r)throw o}}this.releaseQueuedMessagesIfReady(e,a)}}}],[{key:"isKlarnaPaymentsReady",value:function(e){e=$86c5e230eba4f632$export$d2ca453b913dcdea.getHandshakeResponseParams(e,$39d6456d60f7b2a5$export$c8a7d7e37b742a82.KlarnaPayments);return null!=e}},{key:"queueMessageIfNeeded",value:function(e,a){return"Native"===a.sender&&a.receiver===$39d6456d60f7b2a5$export$c8a7d7e37b742a82.KlarnaPaymentsWrapper&&a.action!==$3e97667694aebf08$export$9d82dedbeb797f41.handshakeResponse&&!i.isKlarnaPaymentsReady(e)&&(e.queuedKlarnaPaymentsMessages.push(a),$dc2b35112bcce9e2$export$efa9a398d6368992.default.info("Message Queued",a),!0)}}]),i}()),$4814da207725bbf9$export$b11de1d3f90d3095=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"processMessage",value:function(e,a,t){"handhakeResponse"===a.action&&(a.action="handshakeResponse")}}]),e}(),$703d4353b2e97418$export$8121b940eecf6dfc=[{osName:"iOS",nativeVersion:"2.0.26"},{osName:"iOS",nativeVersion:"2.0.27"},{osName:"iOS",nativeVersion:"2.0.28"},{osName:"android",nativeVersion:"2.0.26"},{osName:"android",nativeVersion:"2.0.27"},{osName:"android",nativeVersion:"2.0.28"},{osName:"android",nativeVersion:"2.0.29"}],$ef3b0819d68510c9$export$9e75f50bdaecb36d=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"processMessage",value:function(e,a,t){if("handshakeResponse"===a.action)try{var r=a.params.osName,o=a.params.nativeVersion,s=!0,d=!1,n=void 0;try{for(var i,c=$703d4353b2e97418$export$8121b940eecf6dfc[Symbol.iterator]();!(s=(i=c.next()).done);s=!0){var f=i.value;if(r===f.osName&&o===f.nativeVersion){var $=a.params.productOptions;if(void 0!==$&&"undefined"!==$&&null!=$){var b=JSON.parse($);if(null!=b&&null!=b.klarnaInitData)try{var l=JSON.parse(b.klarnaInitData);b.klarnaInitData=l,a.params.productOptions=JSON.stringify(b)}catch(e){var u="Error parsing klarnaInitData parameter inside productOptions: ";try{u+=JSON.stringify(e)}catch(e){}finally{$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("rewrite-productOptions",{msg:u})}}}}}}catch(e){d=!0,n=e}finally{try{s||null==c.return||c.return()}finally{if(d)throw n}}}catch(e){d="Error parsing productOptions parameter: ";try{d+=JSON.stringify(e)}catch(e){}finally{$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("rewrite-productOptions",{msg:d})}}}}]),e}(),$3a048628b2890696$export$eed1627e80a5b594=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"processMessage",value:function(e,a,t){if("setExperiments"===a.action){try{var r;void 0!==a.params.experiments&&"undefined"!==a.params.experiments&&null!=a.params.experiments&&(r=a.params.experiments,$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("rewrite-experiments-info",{msg:"Experiments JSON received: "+r}),"string"!=typeof r)&&(a.params.experiments=JSON.stringify(r))}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("rewrite-experiments",{msg:"Error stringifying experiments parameter sent from KP: "+JSON.stringify(e)})}try{if(void 0!==a.params.experiments&&"undefined"!==a.params.experiments&&null!=a.params.experiments){var o=a.params.experiments;if("string"==typeof o){var s,d=JSON.parse(o),n=[];for(s in d){var i=d[s];null!=i.variate&&void 0!==i.variate||(i.variate=""),n.push(i)}a.params.experiments=JSON.stringify(n)}}}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("rewrite-experiments-variates",{msg:"Error adding missing variate parameter in experiments sent from KP: "+JSON.stringify(e)})}}}}]),e}(),$ecbd5ca65160a7bb$export$b385821f0f78b939=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"processMessage",value:function(e,a,t){"handshake"===a.action&&"KlarnaPaymentsWrapper"===a.sender&&window.__WrapperMessageController&&window.__WrapperMessageController._extractBase64&&(window.__WrapperMessageController._extractBase64=function(e,a,t){if(null==e.params[t]||"null"===e.params[t])return null;try{var r=e.params[t],o=atob(r);return JSON.parse(o)}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("extract-b64",{msg:"Error extracting b64 with custom atob() "+JSON.stringify(e)})}})}}]),e}(),$20b9286aec418fd6$export$d2210066b6438afd=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"processMessage",value:function(e,a,t){if("actionToComponent"===a.action)try{var r;"undefined"!==a.params.sessionData&&null!=a.params.sessionData&&("null"===a.params.sessionData?delete a.params.sessionData:(r=a.params.sessionData,a.params.sessionData=$e46f7c82eed16cd3$export$5e8778959ee066ba+r.replace(/\n/g,"").replace(/-/g,"+").replace(/_/g,"/")))}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("re-format-session-data",{msg:"Error reformatting session data: "+JSON.stringify(e)})}}}]),e}(),$7fa6dffb869bcbcd$export$c7c9b199d5b7287c=function(){function r(){$737874114c2a80d9$export$2996f80ef42b8419(this,r)}return $4a1bdc4745d43223$export$d60067ff2358eee8(r,[{key:"processMessage",value:function(e,a,t){"fullscreenShow"===a.action&&"android"===(null==(e=r.getHandshakeResponseParams(e,a,t))?void 0:e.osName)&&(a.params.canScroll="true")}}],[{key:"getHandshakeResponseParams",value:function(e,a,t){return t?$86c5e230eba4f632$export$d2ca453b913dcdea.getHandshakeResponseParams(e,a.receiver):$86c5e230eba4f632$export$d2ca453b913dcdea.getHandshakeResponseParams(e,a.sender)}}]),r}(),$c8630f9c56e73faf$export$c19720cc6ee85749=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"processMessage",value:function(a,e,t){if(e.action===$3e97667694aebf08$export$9d82dedbeb797f41.handshakeResponse)try{a.handshakeResponseParamsMap[e.receiver]=e.params,$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("Cached handshake",e.receiver,e.params)}catch(e){a="Error caching handshake response params: ";try{a+=JSON.stringify(e)}catch(e){}finally{$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("cache-handshakeResponseParams",{msg:a})}}}}]),e}(),$af2a197b0dc9b6ac$export$2cabd05dec5a966a=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e),this.nativeMessageSender=new $85771519b3f11699$export$15f59c3f623e5e81,this.componentMessageSender=new $9524e81dfe28183b$export$2cdde459a873087f,this.messageProcessors=[new $4814da207725bbf9$export$b11de1d3f90d3095,new $ef3b0819d68510c9$export$9e75f50bdaecb36d,new $3a048628b2890696$export$eed1627e80a5b594,new $ecbd5ca65160a7bb$export$b385821f0f78b939,new $20b9286aec418fd6$export$d2210066b6438afd,new $7fa6dffb869bcbcd$export$c7c9b199d5b7287c,new $c8630f9c56e73faf$export$c19720cc6ee85749]}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"postMessage",value:function(t,r,o){o&&t.crossWindowController.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Root&&t.crossWindowController.postMessage(new $3f8d71218c98a45f$export$137d9274eb4bdc8d($ec5a25b0ccdbabd5$export$d6ff711ee8724594.PostReceiverMessage,r)),this.messageProcessors.forEach(function(e,a){e.processMessage(t,r,o)}),this.componentMessageSender.sendMessage(t,r),o||this.nativeMessageSender.sendMessage(t,r)}},{key:"postEventMessageToNative",value:function(e,a){this.nativeMessageSender.postEventMessageToNative(e,a)}}]),e}(),$4fd8e36a662dd81b$export$d1b1e53e547a4664=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e),this._isSdkWebView=!1}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"isNativeReady",value:function(e){return e.nativeReady}},{key:"isNativeReadyAsync",value:function(o){return o.crossWindowController.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Root?new Promise(function(e){return e(o.isNativeReady())}):new Promise(function(a,e){var t=window.setTimeout(function(){e("CrossWindowMessage Response Timeout")},3e3),r=new $3f8d71218c98a45f$export$137d9274eb4bdc8d($ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsNativeReadyRequest,null);o.crossWindowController.postMessage(r,function(e){return e.action===$ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsNativeReadyResponse&&(e=e.data,window.clearTimeout(t),a(e.isNativeReady)),!1})})}},{key:"isSdkWebView",value:function(e){var a,t;return(a=null!=this.getNativeMessageHandler())!=this._isSdkWebView&&(e.crossWindowController.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Root?(t=new $976c9715c78f6b69$export$15f24e2438b5a10d(a),t=new $3f8d71218c98a45f$export$137d9274eb4bdc8d($ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsSdkWebViewResponse,t),e.crossWindowController.postMessage(t),this._isSdkWebView=a):a&&(this._isSdkWebView=a)),this._isSdkWebView}},{key:"isSdkWebViewAsync",value:function(o){var s=this;return o.crossWindowController.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Root?new Promise(function(e){return e(s.isSdkWebView(o))}):new Promise(function(a,e){var t=window.setTimeout(function(){e("CrossWindowMessage Response Timeout")},3e3),r=new $3f8d71218c98a45f$export$137d9274eb4bdc8d($ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsSdkWebViewRequest,null);o.crossWindowController.postMessage(r,function(e){return e.action===$ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsSdkWebViewResponse&&(s._isSdkWebView=(e=e.data).isSdkWebView,window.clearTimeout(t),a(e.isSdkWebView)),!1})})}},{key:"setNativeReady",value:function(e){if(e.nativeReady)e.messageController.postEventMessageToNative(e,new $54e9de874e7cf259$export$468fbe6771f1699e($b4efb1694e6b9d0a$export$a96b0bbdbd70b734.MessageBridgeAlreadyRunning,null,null,null)),e.notifyEvent({name:"NativeHookAlreadyReady",payload:{receivers:e.receivers.toString(),queuedMessages:e.queuedMessages.toString()}});else{e.nativeReady=!0,e.messageController.postEventMessageToNative(e,new $54e9de874e7cf259$export$468fbe6771f1699e($b4efb1694e6b9d0a$export$a96b0bbdbd70b734.MessageBridgeWillStart,null,null,null));var a=!0,t=!1,r=void 0;try{for(var o,s=e.receivers.filter(function(e){return!e.registeredNatively})[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var d=o.value;e.messageController.postEventMessageToNative(e,new $54e9de874e7cf259$export$468fbe6771f1699e($b4efb1694e6b9d0a$export$a96b0bbdbd70b734.ReceiverAdded,d.name,null,null)),d.registeredNatively=!0}}catch(e){t=!0,r=e}finally{try{a||null==s.return||s.return()}finally{if(t)throw r}}var n=!0,t=!1,r=void 0;try{for(var i,c=e.queuedMessages[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){var f=i.value;e.messageController.postEventMessageToNative(e,new $54e9de874e7cf259$export$468fbe6771f1699e($b4efb1694e6b9d0a$export$a96b0bbdbd70b734.MessagePosted,null,f,null))}}catch(e){t=!0,r=e}finally{try{n||null==c.return||c.return()}finally{if(t)throw r}}e.queuedMessages=[],e.crossWindowController.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Root&&(t=new $24815a6cb6024ef5$export$a9cf52565e7ce5db(e.nativeReady),r=new $3f8d71218c98a45f$export$137d9274eb4bdc8d($ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsNativeReadyResponse,t),e.crossWindowController.postMessage(r)),e.notifyEvent({name:"NativeHookReady",payload:{receivers:e.receivers.toString(),queuedMessages:e.queuedMessages.toString()}})}}},{key:"setIsSdkWebView",value:function(e){this._isSdkWebView=e}},{key:"getNativeMessageHandler",value:function(){return e.getNativeMessageHandler()}}]),e}(),$0cdf7169dbc5007b$export$59e2a0f060df91e7=($4fd8e36a662dd81b$export$d1b1e53e547a4664.getNativeMessageHandler=function(){var e;return window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.KlarnaNativeHookMessageHandler?e=window.webkit.messageHandlers.KlarnaNativeHookMessageHandler:window.KlarnaNativeHookMessageHandler&&(e=window.KlarnaNativeHookMessageHandler),e},function e(a,t){$737874114c2a80d9$export$2996f80ef42b8419(this,e),this.registeredNatively=!1,this.id=$86c5e230eba4f632$export$d2ca453b913dcdea.createUUIDv4(),this.name=a,this.callback=t}),$9e8cdbfcf67b38ba$export$fb16809fa2eec8fa=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e)}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"addReceiver",value:function(e,a,t){a=new $0cdf7169dbc5007b$export$59e2a0f060df91e7(a,t);e.nativeReady&&(e.messageController.postEventMessageToNative(e,new $54e9de874e7cf259$export$468fbe6771f1699e($b4efb1694e6b9d0a$export$a96b0bbdbd70b734.ReceiverAdded,a.name,null,null)),a.registeredNatively=!0),e.receivers.push(a)}},{key:"removeReceiver",value:function(e,a,t){e.receivers=e.receivers.filter(function(e){return e.name!==a&&e.callback!==t}),e.nativeReady&&e.messageController.postEventMessageToNative(e,new $54e9de874e7cf259$export$468fbe6771f1699e($b4efb1694e6b9d0a$export$a96b0bbdbd70b734.ReceiverRemoved,a,null,null))}}]),e}(),$9ecb142aad0a6028$export$94c0504e844c22d2=function(){function e(){$737874114c2a80d9$export$2996f80ef42b8419(this,e),this.nativeReady=!1,this.receivers=[],this.queuedMessages=[],this.queuedKlarnaPaymentsMessages=[],this.version=$e46f7c82eed16cd3$export$3ab5d4b363e83ecc,this.eventListeners=[],this.handshakeResponseParamsMap={},this.base64Controller=new $ab11a08eff1af618$export$3b418aac0e066580,this.messageController=new $af2a197b0dc9b6ac$export$2cabd05dec5a966a,this.crossWindowController=new $4056916c3e7cc48b$export$8697e044b6ceac7e(this),this.nativeController=new $4fd8e36a662dd81b$export$d1b1e53e547a4664,this.receiverController=new $9e8cdbfcf67b38ba$export$fb16809fa2eec8fa,this.base64Controller.overrideDefaults(),this.setupCrossWindowController()}return $4a1bdc4745d43223$export$d60067ff2358eee8(e,[{key:"addReceiver",value:function(a,e){try{this.receiverController.addReceiver(this,a,e),this.notifyEvent({name:"AddedReceiver",payload:{name:a}})}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("MessageBridge.addReceiver failed.",e),this.notifyEvent({name:"AddReceiverFailed",payload:{name:a,error:e.toString()}})}}},{key:"removeReceiver",value:function(a,e){try{this.receiverController.removeReceiver(this,a,e),this.notifyEvent({name:"RemovedReceiver",payload:{name:a}})}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("MessageBridge.removeReceiver failed.",e),this.notifyEvent({name:"RemoveReceiverFailed",payload:{name:a,error:e.toString()}})}}},{key:"postMessage",value:function(a){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];try{this.messageController.postMessage(this,a,e)}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("MessageBridge.postMessage failed.",e),this.notifyEvent({name:"PostMessageFailed",payload:{action:a.action,sender:a.sender,receiver:a.receiver,error:e.toString()}})}}},{key:"isNativeReady",value:function(){return this.nativeController.isNativeReady(this)}},{key:"isNativeReadyAsync",value:function(){return this.nativeController.isNativeReadyAsync(this)}},{key:"setNativeReady",value:function(){try{this.nativeController.setNativeReady(this),this.reportEndpoints()}catch(e){$dc2b35112bcce9e2$export$efa9a398d6368992.default.error("MessageBridge.setNativeReady failed.",e),this.notifyEvent({name:"NativeHookSetNativeReadyFailed",payload:{receivers:this.receivers.toString(),queuedMessages:this.queuedMessages.toString(),error:e.toString()}})}}},{key:"inSdkWebView",value:function(){try{return this.nativeController.isSdkWebView(this)}catch(e){return $dc2b35112bcce9e2$export$efa9a398d6368992.default.error("MessageBridge.inSdkWebView failed.",e),!1}}},{key:"inSdkWebViewAsync",value:function(){return this.nativeController.isSdkWebViewAsync(this)}},{key:"addEventListener",value:function(e){this.eventListeners.indexOf(e)<=-1&&this.eventListeners.push(e)}},{key:"removeEventListener",value:function(a){this.eventListeners=this.eventListeners.filter(function(e){return e!=a})}},{key:"notifyEvent",value:function(a){this.eventListeners.forEach(function(e){return e(a)})}},{key:"compareVersion",value:function(e,a){try{return $86c5e230eba4f632$export$d2ca453b913dcdea.compareVersion(e,a)}catch(e){return $dc2b35112bcce9e2$export$efa9a398d6368992.default.error("MessageBridge.compareVersion failed.",e),0}}},{key:"destroy",value:function(){this.teardownCrossWindowController()}},{key:"setupCrossWindowController",value:function(){var e;this.crossWindowController.register(this),this.crossWindowController.mode===$fa9011cb1dfb6667$export$caf75cbffb0ca40.Frame?(e=new $3f8d71218c98a45f$export$137d9274eb4bdc8d($ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsNativeReadyRequest,null),this.crossWindowController.postMessage(e),e=new $3f8d71218c98a45f$export$137d9274eb4bdc8d($ec5a25b0ccdbabd5$export$d6ff711ee8724594.IsSdkWebViewRequest,null),this.crossWindowController.postMessage(e)):this.nativeController.isSdkWebView(this),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("CrossWindowController Setup")}},{key:"teardownCrossWindowController",value:function(){this.crossWindowController.unregister(this),$dc2b35112bcce9e2$export$efa9a398d6368992.default.debug("CrossWindowController Teardown")}},{key:"reportEndpoints",value:function(){var e=new $e27faf65630ebc9a$export$e12b769011d096b4(this.version,new $f12b5d7f8ad4b8dc$export$33b0bc6879c27206($a527415fb53b3e91$export$eed022e50baffed5.Analytics.Staging,$a527415fb53b3e91$export$eed022e50baffed5.Analytics.Production),new $f12b5d7f8ad4b8dc$export$33b0bc6879c27206($a527415fb53b3e91$export$eed022e50baffed5.DeviceData.Staging,$a527415fb53b3e91$export$eed022e50baffed5.DeviceData.Production));this.messageController.postEventMessageToNative(this,new $54e9de874e7cf259$export$468fbe6771f1699e($b4efb1694e6b9d0a$export$a96b0bbdbd70b734.EndpointsReported,null,null,e))}}]),e}();try{null==window.__KlarnaNativeHook?window.__KlarnaNativeHook=new $9ecb142aad0a6028$export$94c0504e844c22d2:1===$86c5e230eba4f632$export$d2ca453b913dcdea.compareVersion($e46f7c82eed16cd3$export$3ab5d4b363e83ecc,window.__KlarnaNativeHook.version)&&$86c5e230eba4f632$export$d2ca453b913dcdea.replaceBridge(window.__KlarnaNativeHook,new $9ecb142aad0a6028$export$94c0504e844c22d2)}catch(e){console.error("__KlarnaNativeHook MessageBridge initialization failed.",e)}