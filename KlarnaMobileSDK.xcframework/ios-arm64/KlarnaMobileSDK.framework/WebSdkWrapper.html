<!doctype html><html><head><meta http-equiv="Content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover"/><meta http-equiv="Content-Security-Policy" content="object-src 'none'; base-uri 'none'; frame-ancestors 'none';"/><title>Web SDK Wrapper</title><script>/*! For license information please see app.js.LICENSE.txt */
(()=>{var e={318:function(e,t,n){!function(e){"use strict";var t,n=function(){try{if(e.URLSearchParams&&"bar"===new e.URLSearchParams("foo=bar").get("foo"))return e.URLSearchParams}catch(e){}return null}(),r=n&&"a=1"===new n({a:1}).toString(),o=n&&"+"===new n("s=%2B").get("s"),s=n&&"size"in n.prototype,i="__URLSearchParams__",a=!n||((t=new n).append("s"," &"),"s=+%26"===t.toString()),l=d.prototype,c=!(!e.Symbol||!e.Symbol.iterator);if(!(n&&r&&o&&a&&s)){l.append=function(e,t){y(this[i],e,t)},l.delete=function(e){delete this[i][e]},l.get=function(e){var t=this[i];return this.has(e)?t[e][0]:null},l.getAll=function(e){var t=this[i];return this.has(e)?t[e].slice(0):[]},l.has=function(e){return b(this[i],e)},l.set=function(e,t){this[i][e]=[""+t]},l.toString=function(){var e,t,n,r,o=this[i],s=[];for(t in o)for(n=g(t),e=0,r=o[t];e<r.length;e++)s.push(n+"="+g(r[e]));return s.join("&")};var u,p=e.Proxy&&n&&(!o||!a||!r||!s);p?(u=new Proxy(n,{construct:function(e,t){return new e(new d(t[0]).toString())}})).toString=Function.prototype.toString.bind(d):u=d,Object.defineProperty(e,"URLSearchParams",{value:u});var h=e.URLSearchParams.prototype;h.polyfill=!0,!p&&e.Symbol&&(h[e.Symbol.toStringTag]="URLSearchParams"),"forEach"in h||(h.forEach=function(e,t){var n=v(this.toString());Object.getOwnPropertyNames(n).forEach((function(r){n[r].forEach((function(n){e.call(t,n,r,this)}),this)}),this)}),"sort"in h||(h.sort=function(){var e,t,n,r=v(this.toString()),o=[];for(e in r)o.push(e);for(o.sort(),t=0;t<o.length;t++)this.delete(o[t]);for(t=0;t<o.length;t++){var s=o[t],i=r[s];for(n=0;n<i.length;n++)this.append(s,i[n])}}),"keys"in h||(h.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),m(e)}),"values"in h||(h.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),m(e)}),"entries"in h||(h.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),m(e)}),c&&(h[e.Symbol.iterator]=h[e.Symbol.iterator]||h.entries),"size"in h||Object.defineProperty(h,"size",{get:function(){var e=v(this.toString());if(h===this)throw new TypeError("Illegal invocation at URLSearchParams.invokeGetter");return Object.keys(e).reduce((function(t,n){return t+e[n].length}),0)}})}function d(e){((e=e||"")instanceof URLSearchParams||e instanceof d)&&(e=e.toString()),this[i]=v(e)}function g(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'\(\)~]|%20|%00/g,(function(e){return t[e]}))}function f(e){return e.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/gi,(function(e){return decodeURIComponent(e)}))}function m(t){var n={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return c&&(n[e.Symbol.iterator]=function(){return n}),n}function v(e){var t={};if("object"==typeof e)if(w(e))for(var n=0;n<e.length;n++){var r=e[n];if(!w(r)||2!==r.length)throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements");y(t,r[0],r[1])}else for(var o in e)e.hasOwnProperty(o)&&y(t,o,e[o]);else{0===e.indexOf("?")&&(e=e.slice(1));for(var s=e.split("&"),i=0;i<s.length;i++){var a=s[i],l=a.indexOf("=");-1<l?y(t,f(a.slice(0,l)),f(a.slice(l+1))):a&&y(t,f(a),"")}}return t}function y(e,t,n){var r="string"==typeof n?n:null!=n&&"function"==typeof n.toString?n.toString():JSON.stringify(n);b(e,t)?e[t].push(r):e[t]=[r]}function w(e){return!!e&&"[object Array]"===Object.prototype.toString.call(e)}function b(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(void 0!==n.g?n.g:"undefined"!=typeof window?window:this)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";n(318);var e,t=function(){function e(){this.searchParams=new URLSearchParams(location.search)}return e.prototype.getBoolean=function(e,t){var n=this.searchParams.get(e);return null!=n?"true"===n:t},e.prototype.getString=function(e){return this.searchParams.get(e)},e.prototype.getNumber=function(e,t){var n=this.searchParams.get(e)||"",r=parseInt(n);return isNaN(r)?t:r},e}();!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.None=4]="None"}(e||(e={}));var r,o=function(){function t(){this._logLevel=e.None}return Object.defineProperty(t,"default",{get:function(){return t._default},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._logLevel===e.Debug&&console.debug.apply(console,t)},t.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._logLevel<=e.Info&&console.info.apply(console,t)},t.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._logLevel<=e.Warn&&console.warn.apply(console,t)},t.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._logLevel<=e.Error&&console.error.apply(console,t)},t._default=new t,t}(),s="https://js.klarna.com/web-sdk/v2/klarna.js",i="Klarna Web SDK",a="klarna.js",l="web-sdk-wrapper",c=function(){function e(e){this.paymentRequest=e}return e.prototype.toParams=function(){var e={};if(this.paymentRequest)try{e.paymentRequest=JSON.stringify(this.paymentRequest)}catch(e){}return e},e}(),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},p=function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},h=function(){function e(e){var t=this;this.onStartInteraction=function(e){return u(t,void 0,void 0,(function(){var t,n;return p(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.mobileSdkMessagingController.loadSeparateFullscreenUrl(e),[4,this.mobileSdkMessagingController.showSeparateFullscreen()];case 1:if(!r.sent().success)throw new Error("Failed to show separate fullscreen: Received success=false response.");return[3,3];case 2:throw t=r.sent(),n="Failed to start interaction with URL: ".concat(e,". ").concat(t),o.default.error(n),new Error(n);case 3:return[2]}}))}))},this.onClose=function(){return u(t,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return[4,this.mobileSdkMessagingController.hideSeparateFullscreen()];case 1:if(!e.sent().success)throw new Error("Failed to hide separate fullscreen: Received success=false response.");return[2]}}))}))},this.mobileSdkMessagingController=e}return e.prototype.startInteraction=function(e){return u(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return[4,this.onStartInteraction(e)];case 1:return t.sent(),[2,this.onClose]}}))}))},e}(),d=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(){function e(e,t){this.isPublic=!1,this.message=e,this.isPublic=t}return e.prototype.toParams=function(){var e={},t={};return t.message=this.message,t.isPublic=this.isPublic?"true":"false",e.error=JSON.stringify(t),e},e}(),f=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.id=null==r?void 0:r.errorId,o.code=null==r?void 0:r.errorCode,o.type=null==r?void 0:r.errorType,o.validationErrors=null==r?void 0:r.validationErrors,o}return d(t,e),t.prototype.toParams=function(){var t=e.prototype.toParams.call(this),n=JSON.parse(t.error);return this.id&&(n.id=this.id),this.code&&(n.code=this.code),this.type&&(n.type=this.type),this.validationErrors&&(n.validationErrors=this.validationErrors),t.error=JSON.stringify(n),t},t}(g),m=function(){function e(){}return e.randomString=function(e){void 0===e&&(e=10);for(var t="",n=0;n<e;n++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t},e}(),v=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},y=function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},w=function(){function e(){this.EVENT_SHIPPING_ADDRESS_CHANGE="shippingaddresschange",this.EVENT_SHIPPING_OPTION_SELECT="shippingoptionselect",this.EVENT_UPDATE="update",this.PROMISE_TIMEOUT_MS=11e3,this.shippingAddressChangeEventId=void 0,this.shippingAddressChangeResolver=void 0,this.shippingOptionSelectEventId=void 0,this.shippingOptionSelectResolver=void 0,this.stateUpdateCallback=void 0}return e.prototype.observeShippingEvents=function(e){this.observeShippingAddressChangeEvents(e),this.observeShippingOptionSelectEvents(e)},e.prototype.sendErrorToNative=function(e,t,n,r,s,i){o.default.error(r),e.actionToNative(t,new f(r,s,i instanceof Error?void 0:i).toParams(),n)},e.prototype.observeShippingAddressChangeEvents=function(e){var t,n,r=this;null===(n=null===(t=window.Klarna)||void 0===t?void 0:t.Payment)||void 0===n||n.on(this.EVENT_SHIPPING_ADDRESS_CHANGE,(function(t,n){o.default.debug("Received shipping address change event.");try{var s={shippingAddress:JSON.stringify(n)};return r.shippingAddressChangeEventId=m.randomString(6),e.actionToNative("paymentShippingAddressChangeRequest",s,r.shippingAddressChangeEventId),new Promise((function(e){r.shippingAddressChangeResolver=e,setTimeout((function(){r.shippingAddressChangeResolver=void 0}),r.PROMISE_TIMEOUT_MS)}))}catch(t){var i="Failed to process the shipping address change event: ".concat(t);r.sendErrorToNative(e,"paymentShippingAddressChangeRequest","",i,!0,t)}}))},e.prototype.observeShippingOptionSelectEvents=function(e){var t,n,r=this;null===(n=null===(t=window.Klarna)||void 0===t?void 0:t.Payment)||void 0===n||n.on(this.EVENT_SHIPPING_OPTION_SELECT,(function(t,n){o.default.debug("Shipping option selected: ".concat(n));var s={shippingOptionReference:n.shippingOptionReference};return r.shippingOptionSelectEventId=m.randomString(6),e.actionToNative("paymentShippingOptionSelectRequest",s,r.shippingOptionSelectEventId),new Promise((function(e){r.shippingOptionSelectResolver=e,setTimeout((function(){r.shippingOptionSelectResolver=void 0}),r.PROMISE_TIMEOUT_MS)}))}))},e.prototype.request=function(e){var t,n;return null===(n=null===(t=window.Klarna)||void 0===t?void 0:t.Payment)||void 0===n?void 0:n.request(e,null)},e.prototype.prepare=function(){return v(this,void 0,void 0,(function(){var e;return y(this,(function(t){return e={interactionMode:"ON_PAGE"},[2,this.request().prepare(void 0,e)]}))}))},e.prototype.initiate=function(e){return window.klarnaMobileAPI=new h(e),this.request().initiate(void 0,{interactionMode:"ON_PAGE"})},e.prototype.fetch=function(){return v(this,void 0,void 0,(function(){return y(this,(function(e){return[2,this.request().fetch()]}))}))},e.prototype.update=function(e){return v(this,void 0,void 0,(function(){return y(this,(function(t){return[2,this.request().update(e)]}))}))},e.prototype.cancel=function(){return v(this,void 0,void 0,(function(){return y(this,(function(e){return[2,this.request().cancel()]}))}))},e.prototype.changeShippingAddress=function(e,t){this.shippingAddressChangeEventId===e?(this.shippingAddressChangeEventId=void 0,this.shippingAddressChangeResolver?(this.shippingAddressChangeResolver(t),this.shippingAddressChangeResolver=void 0):o.default.warn("shippingAddressChangeResolver is undefined.")):o.default.warn("Ignoring shipping address change value, current messageId value is different.")},e.prototype.selectShippingOption=function(e,t){this.shippingOptionSelectEventId===e?(this.shippingOptionSelectEventId=void 0,this.shippingOptionSelectResolver?(this.shippingOptionSelectResolver(t),this.shippingOptionSelectResolver=void 0):o.default.warn("shippingOptionSelectResolver is undefined.")):o.default.warn("Ignoring shipping address change value, current messageId value is different.")},e.prototype.setOnStateUpdateCallback=function(e){var t=this;void 0===this.stateUpdateCallback&&(this.stateUpdateCallback=function(t){e.actionToNative("paymentStateUpdate",new c(t).toParams(),void 0)},window.Klarna.Payment.on(this.EVENT_UPDATE,(function(e){var n;o.default.debug("Payment request state updated. New state = ".concat(e.state,", Request ID = ").concat(e.paymentRequestId)),null===(n=t.stateUpdateCallback)||void 0===n||n.call(t,e)})))},e}(),b=function(){function e(){}return e.prototype.placement=function(e,t){var n,r;try{this.klarnaPlacement=null===(r=null===(n=window.Klarna)||void 0===n?void 0:n.Messaging)||void 0===r?void 0:r.placement(e),t(!0)}catch(e){t(!1),o.default.error("Error creating messaging placement. ".concat(e))}},e.prototype.mount=function(e,t){if(!(null==this?void 0:this.klarnaPlacement))return o.default.error("klarnaPlacement is undefined."),void t(!1);try{this.klarnaPlacement=this.klarnaPlacement.mount(e),t(!0)}catch(e){o.default.error("Error mounting messaging placement. ".concat(e)),t(!1)}},e.prototype.umount=function(e){if(!(null==this?void 0:this.klarnaPlacement))return o.default.error("klarnaPlacement is undefined."),void e(!1);try{this.klarnaPlacement=this.klarnaPlacement.unmount(),e(!0)}catch(t){o.default.error("Error unmounting messaging placement. ".concat(t)),e(!1)}},e}(),S=function(){function e(e,t,n){void 0===t&&(t=new w),void 0===n&&(n=new b),this._webSdkInitialized=!1,this.webSdkLoader=e,this.klarnaPaymentController=t,this.klarnaMessagingController=n}return Object.defineProperty(e.prototype,"webSdkInitialized",{get:function(){return this._webSdkInitialized},enumerable:!1,configurable:!0}),e.prototype.initializeWebSdk=function(e){return function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))}(this,void 0,void 0,(function(){var t,n;return function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,(function(r){switch(r.label){case 0:if(!this.webSdkLoader.isWebSDKAdded||null==window.Klarna)throw new g("".concat(i," has not been added to the page. Call WebSdkLoader.addWebSdk before calling initializeWebSdk."),!1);if(this.webSdkInitialized)return o.default.error("".concat(i," has already been initialized.")),[2];o.default.debug("Initializing ".concat(i,"...")),r.label=1;case 1:return r.trys.push([1,3,,4]),t=window,[4,window.Klarna.init(e)];case 2:return t.Klarna=r.sent(),this._webSdkInitialized=!0,[3,4];case 3:throw n=r.sent(),new g("Failed to initialize ".concat(i,". ").concat(n),!1);case 4:return[2]}}))}))},e}();function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){C(e,t,n[t])}))}return e}let P="Native";class A{static loadScript(e,t=1e4,n=document){return new Promise(((r,o)=>{setTimeout((()=>{o(Error(`Loading of ${e} timed out.`))}),t);let s=n.createElement("script");s.src=e,s.onload=r,(n.body||n.head).appendChild(s)}))}}class E{getBridge(e=window){return null==this.bridgePromise&&(this.bridgePromise=this.loadMessageBridge(e)),this.bridgePromise}async loadMessageBridge(e=window){return null==e.__KlarnaMessagingBridgeLoaderPromise&&(e.__KlarnaMessagingBridgeLoaderPromise=A.loadScript("https://x.klarnacdn.net/mobile-sdk/mobile-js-snippet/v1/app.min.js").then((()=>e.__KlarnaNativeHook?e.__KlarnaNativeHook:null))),e.__KlarnaMessagingBridgeLoaderPromise}constructor(){this.bridgePromise=null}}class I{}I.handshake="handshake",I.setExperiments="setExperiments",I.toggleLogging="toggleLogging",I.logMessage="logMessage",I.getApiFeatures="getApiFeatures",I.componentStatus="componentStatus",I.httpRequest="httpRequest",I.heightChanged="heightChanged",I.actionToNative="actionToNative",I.testExternalApp="testExternalApp",I.openExternalApp="openExternalApp",I.openExternalBrowser="openExternalBrowser",I.showInternalBrowser="showInternalBrowser",I.hideInternalBrowser="hideInternalBrowser",I.showSandboxedInternalBrowser="showSandboxedInternalBrowser",I.focusScroll="focusScroll",I.fullscreenReplaceWebView="fullscreenReplaceWebView",I.fullscreenMoveWebView="fullscreenMoveWebView",I.fullscreenReplaceOverlay="fullscreenReplaceOverlay",I.fullscreenRestoreWebView="fullscreenRestoreWebView",I.fullscreenLoadUrl="fullscreenLoadUrl",I.fullscreenShow="fullscreenShow",I.fullscreenHide="fullscreenHide",I.shareFile="shareFile",I.showAuthenticationBrowser="showAuthenticationBrowser",I.actionToComponent="actionToComponent",I.applicationBackgrounded="applicationBackgrounded",I.applicationForegrounded="applicationForegrounded",I.backButtonPressed="backButtonPressed",I.hideOnUrlInternalBrowser="hideOnUrlInternalBrowser";let M=new Map([[I.handshake,{hasResponse:!0}],[I.setExperiments,{hasResponse:!1}],[I.toggleLogging,{hasResponse:!1}],[I.logMessage,{hasResponse:!1}],[I.getApiFeatures,{hasResponse:!0}],[I.componentStatus,{hasResponse:!1}],[I.httpRequest,{hasResponse:!0}],[I.heightChanged,{hasResponse:!1}],[I.actionToNative,{hasResponse:!1}],[I.actionToComponent,{hasResponse:!1}],[I.testExternalApp,{hasResponse:!0}],[I.openExternalApp,{hasResponse:!0}],[I.openExternalBrowser,{hasResponse:!0}],[I.showInternalBrowser,{hasResponse:!0}],[I.hideInternalBrowser,{hasResponse:!0}],[I.showSandboxedInternalBrowser,{hasResponse:!0}],[I.focusScroll,{hasResponse:!1}],[I.fullscreenReplaceWebView,{hasResponse:!0}],[I.fullscreenMoveWebView,{hasResponse:!0}],[I.fullscreenReplaceOverlay,{hasResponse:!0}],[I.fullscreenRestoreWebView,{hasResponse:!0}],[I.fullscreenLoadUrl,{hasResponse:!0}],[I.fullscreenShow,{hasResponse:!0}],[I.fullscreenHide,{hasResponse:!0}],[I.shareFile,{hasResponse:!0}],[I.showAuthenticationBrowser,{hasResponse:!0}]]),R=[I.actionToComponent,I.applicationBackgrounded,I.applicationForegrounded,I.backButtonPressed,I.hideOnUrlInternalBrowser];class N{static stringifyProperties(e){let t={};if(null!=e&&"object"==typeof e){let n=Object.getOwnPropertyNames(e);for(let r of n){let n=Reflect.get(e,r),o=N.stringify(n);null!=o&&(t[r]=o)}}return t}static stringify(e){if(null!=e){if("object"==typeof e)return JSON.stringify(e);if("boolean"==typeof e)return e?"true":"false";if("number"==typeof e)return e.toString();if("string"==typeof e)return e;console.error("Failed to map value of type "+typeof e)}else console.error("Failed to map null value")}static parse(e){if(null!=e)try{return JSON.parse(e)}catch(t){console.error(`Failed to parse value: ${e}`)}else console.error("Failed to parse null value")}}class O{messageReceived(e){let t=this.callbacks.get(e.messageId);null!=t?t(e.params):null!=this.receiverController?this.receiverController.actionReceived(e.action,{params:e.params,sender:e.sender,messageId:e.messageId}):console.error("ReceiverController is not available.")}callAction(e,t,n=P,r){return new Promise((o=>{var s;let i=null!=r&&r.length>0?r:this.generateId(),a=1==(null===(s=M.get(e))||void 0===s?void 0:s.hasResponse);a&&this.callbacks.set(i,o);let l=this.mapToNativeHookMessageParams(t),c={receiver:n,sender:this.component,messageId:i,action:e,params:l};this.sendMessage(c),a||o(void 0)}))}sendMessage(e){let t=window.__KlarnaNativeHook;return null!=t?(t.postMessage(e),!0):(this.actionsQueue.push(e),!1)}flushActionsQueue(){for(;this.actionsQueue.length;){let e=this.actionsQueue.shift();null!=e&&this.sendMessage(e)}}mapToNativeHookMessageParams(e){return N.stringifyProperties(e)}constructor(e,t,n){var r;this.actionsQueue=[],this.callbacks=new Map,this.generateId=(r=0,()=>String(++r)),this.receiverCallback=e=>{this.messageReceived(e)},this.component=e,this.receiverController=n,t.getBridge().then((e=>{null!=e?(e.addReceiver(this.component,this.receiverCallback),this.flushActionsQueue()):console.error("BridgeController failed to resolve MessageBridge.")}))}}class x{constructor(e){this.messageController=e}}function T(e){if(null!=e){let t,n;return Array.isArray(e.features)?t=e.features:"string"==typeof e.features&&(t=JSON.parse(e.features)),"object"==typeof e.productOptions?n=e.productOptions:"string"==typeof e.productOptions&&(n=JSON.parse(e.productOptions)),{nativeName:e.nativeName,nativeVersion:e.nativeVersion,nativeBuildNumber:e.nativeBuildNumber,merchantAppName:e.merchantAppName,merchantAppID:e.merchantAppID,merchantAppVersion:e.merchantAppVersion,merchantAppBuildNumber:e.merchantAppBuildNumber,merchantReturnURL:e.merchantReturnURL,osName:e.osName,osVersion:e.osVersion,deviceName:e.deviceName,features:t,inAppSDKHeader:e["Klarna-In-App-SDK"],productOptions:n}}}async function D(e,t){return new Promise(((n,r)=>{t.then((t=>{let o=e(t);null!=o?n(o):r("Could not parse promise response")})).catch((e=>{r(e)}))}))}class F extends x{async handshakeAction(e,t){return D(T,this.messageController.callAction(I.handshake,{componentName:e,componentVersion:t}))}}class B extends x{setExperiments(e){let t={experiments:JSON.stringify(e)};this.messageController.callAction(I.setExperiments,t)}}class U extends x{toggleLogging(e,t){let n={shouldLogToConsoleApp:e.toString(),level:t};this.messageController.callAction(I.toggleLogging,n)}logMessage(e,t){this.messageController.callAction(I.logMessage,{message:e,type:t})}}function W(e){if(null!=e){if(Array.isArray(e.features))return{features:e.features};if("string"==typeof e.features)return{features:JSON.parse(e.features)}}}class _ extends x{async getApiFeatures(){return D(W,this.messageController.callAction("getApiFeatures",{}))}}class L extends x{sendComponentStatus(e){this.messageController.callAction(I.componentStatus,e)}}function q(e){if(null!=e){let t,n,r;return"string"==typeof e.status?t=parseInt(e.status):"number"==typeof e.status&&(t=e.status),"string"==typeof e.headers?n=JSON.parse(e.headers):"object"==typeof e.headers&&(n=e.headers),"string"==typeof e.body?r=JSON.parse(e.body):"object"==typeof e.body&&(r=e.body),{status:t,headers:n,body:r,message:e.message}}}class K extends x{async sendNetworkRequest(e,t,n,r,o,s){let i={url:e,method:t,headers:"object"==typeof n?JSON.stringify(n):n,body:"object"==typeof r?JSON.stringify(r):r,followRedirects:o.toString(),timeout:null==s?void 0:s.toString()};return D(q,this.messageController.callAction(I.httpRequest,i))}}class V extends x{notifyHeightChange(e){let t={height:e.toString()};this.messageController.callAction(I.heightChanged,t)}}class j extends x{sendMerchantEvent(e,t){let n={actionType:"merchant",name:e,body:JSON.stringify(t),isError:(!1).toString(),isFatal:void 0};this.messageController.callAction(I.actionToNative,n)}sendMerchantError(e,t,n){let r={actionType:"merchant",name:e,body:JSON.stringify(t),isError:(!0).toString(),isFatal:null==n?void 0:n.toString()};this.messageController.callAction(I.actionToNative,r)}}function z(e){if(null!=e&&"string"==typeof e.url){if("boolean"==typeof e.success)return{url:e.url,success:e.success};if("string"==typeof e.success)return{url:e.url,success:"true"===e.success}}}function H(e){if(null!=e&&"string"==typeof e.url&&"string"==typeof e.available)return{url:e.url,availability:e.available.toLowerCase()}}class J extends x{async testExternalApp(e){return D(H,this.messageController.callAction(I.testExternalApp,{url:e}))}async openExternalApp(e){return D(z,this.messageController.callAction(I.openExternalApp,{url:e}))}}class Q extends x{async openExternalBrowser(e){return D(z,this.messageController.callAction(I.openExternalBrowser,{url:e}))}}function G(e){if(null!=e){if("boolean"==typeof e.success)return{success:e.success,source:e.source};if("string"==typeof e.success)return{success:"true"===e.success,source:e.source}}}function $(e){if(null!=e){if("boolean"==typeof e.success)return{success:e.success};if("string"==typeof e.success)return{success:"true"===e.success}}}(ge=Se||(Se={})).component="component",ge.user="user",ge.hideOnUrl="hideOnUrl",ge.threeds="3ds",ge.externalApp="externalApp";class X extends x{async showInternalBrowser(e,t){let n={url:e,hideOnUrls:JSON.stringify(t)};return D($,this.messageController.callAction(I.showInternalBrowser,n))}async hideInternalBrowser(){return D(G,this.messageController.callAction(I.hideInternalBrowser,{}))}}class Y extends x{showSandboxBrowser(e){return D($,this.messageController.callAction(I.showSandboxedInternalBrowser,{url:e}))}}class Z extends x{focusScroll(e,t,n,r,o){let s={top:e.toString(),left:t.toString(),width:n.toString(),height:r.toString(),animated:null==o?void 0:o.toString()};this.messageController.callAction(I.focusScroll,s)}}class ee{push(e){this._store.push(e)}pop(){return this._store.shift()}get length(){return this._store.length}constructor(){this._store=[]}}(fe=Ce||(Ce={})).showMovingFullscreen="showMovingFullscreen",fe.hideMovingFullscreen="hideMovingFullscreen";class te extends x{async showMovingFullscreen(e,t){return new Promise((n=>{this.showMovingFullscreenInternal(e,t,n)}))}async hideMovingFullscreen(){return new Promise((e=>{this.hideMovingFullscreenInternal(e)}))}shouldAwaitQueue(){return this.methodCallsQueue.length>0||this.methodInProgress}async processQueue(){if(this.methodInProgress||this.processInProgress)return;this.processInProgress=!0;let e=async()=>{let t=this.methodCallsQueue.pop();if(t){switch(t.method){case Ce.showMovingFullscreen:var n,r;await this.showMovingFullscreenInternal(null===(n=t.params)||void 0===n?void 0:n.shouldScrollToTop,null===(r=t.params)||void 0===r?void 0:r.animated,t.resolve);break;case Ce.hideMovingFullscreen:await this.hideMovingFullscreenInternal(t.resolve)}await e()}else this.processInProgress=!1};await e()}async showMovingFullscreenInternal(e,t,n){if(this.shouldAwaitQueue())return void this.methodCallsQueue.push({method:Ce.showMovingFullscreen,params:{shouldScrollToTop:e,animated:t},resolve:n});this.methodInProgress=!0;let r=await this.replaceWebView();if(r.success){let r=await this.moveWebView(e,t);r.success||(await this.restoreWebView()).success,this.methodInProgress=!1,n(r)}else this.methodInProgress=!1,n(r);this.processQueue()}async hideMovingFullscreenInternal(e){if(this.shouldAwaitQueue())return void this.methodCallsQueue.push({method:Ce.hideMovingFullscreen,resolve:e});this.methodInProgress=!0;let t=await this.replaceOverlay();if(t.success){let t=await this.restoreWebView();t.success||(await this.moveWebView(!1,!1)).success,this.methodInProgress=!1,e(t)}else this.methodInProgress=!1,e(t);this.processQueue()}async replaceWebView(){return D($,this.messageController.callAction(I.fullscreenReplaceWebView,{}))}async moveWebView(e,t){return D($,this.messageController.callAction(I.fullscreenMoveWebView,{shouldScrollToTop:e?"true":void 0,animated:t?"true":void 0}))}async replaceOverlay(){return D($,this.messageController.callAction(I.fullscreenReplaceOverlay,{}))}async restoreWebView(){return D($,this.messageController.callAction(I.fullscreenRestoreWebView,{}))}constructor(...e){super(...e),this.methodCallsQueue=new ee,this.methodInProgress=!1,this.processInProgress=!1}}class ne extends x{loadFullscreenUrl(e){this.messageController.callAction(I.fullscreenLoadUrl,{url:e})}async showFullscreen(e,t,n,r,o,s){let i={placement:e,initialHeight:null==t?void 0:t.toString(),background:n,canScroll:null==r?void 0:r.toString(),canDismiss:null==o?void 0:o.toString(),hideOnUrls:JSON.stringify(s)};return D($,this.messageController.callAction(I.fullscreenShow,i))}async hideFullscreen(){return D($,this.messageController.callAction(I.fullscreenHide,{}))}}class re extends x{actionToNative(e,t,n){let r=k({actionType:e},t);this.messageController.callAction(I.actionToNative,r,P,n)}}class oe extends x{actionToComponent(e,t,n,r){let o=k({actionType:t},n);this.messageController.callAction(I.actionToComponent,o,e,r)}}class se extends x{async shareFile(e,t){return D($,this.messageController.callAction(I.shareFile,{dataUri:e,fileName:t}))}}function ie(e){if(null!=e&&"string"==typeof e.key){let t=e.key;if("string"==typeof e.value)return{key:t,value:e.value};if(void 0===e.value)return{key:t,value:void 0}}}class ae extends x{getData(e){return D(ie,this.messageController.callAction("getData",{key:e}))}putData(e,t){return D(ie,this.messageController.callAction("putData",{key:e,value:t})).then((t=>({success:t.key===e}))).catch((()=>({success:!1})))}}function le(e){if(null!=e&&"string"==typeof e.reason){let t=e.reason;switch(typeof e.success){case"boolean":return{success:e.success,reason:t};case"string":return{success:"true"===e.success,reason:t}}}}class ce extends x{async showAuthenticationBrowser(e){return D(le,this.messageController.callAction(I.showAuthenticationBrowser,{url:e}))}}class ue{constructor(e){this.handshakeDelegate=new F(e),this.experimentsDelegate=new B(e),this.loggingDelegate=new U(e),this.apiFeaturesDelegate=new _(e),this.componentStatusDelegate=new L(e),this.networkDelegate=new K(e),this.sizeChangeDelegate=new V(e),this.merchantMessageDelegate=new j(e),this.dataStoreDelegate=new ae(e),this.externalAppDelegate=new J(e),this.externalBrowserDelegate=new Q(e),this.internalBrowserDelegate=new X(e),this.sandboxBrowserDelegate=new Y(e),this.scrollDelegate=new Z(e),this.movingFullscreenDelegate=new te(e),this.separateFullscreenDelegate=new ne(e),this.contentSharingDelegate=new se(e),this.authenticationBrowserDelegate=new ce(e),this.nativeActionDelegate=new re(e),this.componentActionDelegate=new oe(e)}}class pe{static find(e,t,n){if(!(null!==e&&e instanceof Array))throw TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw TypeError("predicate must be a function");if(void 0!==Array.prototype.find)return e.find(t,n);let r=Object(e),o=r.length>>>0;for(let e=0;e<o;e++){let o=r[e];if(t.call(n,o,e,r))return o}}static includes(e,t,n){return void 0!==this.find(e,t,n)}}class he{registerCallback(e,t){pe.includes(R,(t=>t===e))?this.actionReceivers.set(e,t):console.error(`Action "${e}" is not an action to component.`)}unregisterCallback(e){this.actionReceivers.delete(e)}actionReceived(e,t){if(pe.includes(R,(t=>t===e))){let n=this.actionReceivers.get(e);null!=n?n(t):console.error(`No callback for action "${e}"`)}else console.error(`Action "${e}" is not an action to component.`)}constructor(){this.actionReceivers=new Map}}(me=ke||(ke={})).full="full",me.top="top",me.bottom="bottom";class de{static init({component:e,componentVersion:t}){return new de({component:e,componentVersion:t})}static isMobileSDKContext({win:e}={win:window}){return!!e.webkit&&!!e.webkit.messageHandlers&&!!e.webkit.messageHandlers.KlarnaNativeHookMessageHandler||!!e.KlarnaNativeHookMessageHandler}onAction({action:e,callback:t}){this.receiverController.registerCallback(e,t)}handshake(){return this.actionsController.handshakeDelegate.handshakeAction(this.component,this.componentVersion)}toggleLogging({shouldLogToConsoleApp:e,level:t}){return this.actionsController.loggingDelegate.toggleLogging(e,t)}logMessage({message:e,level:t}){return this.actionsController.loggingDelegate.logMessage(e,t)}getApiFeatures(){return this.actionsController.apiFeaturesDelegate.getApiFeatures()}setExperiments({experiments:e}){return this.actionsController.experimentsDelegate.setExperiments(e)}sendComponentStatus({params:e}){return this.actionsController.componentStatusDelegate.sendComponentStatus(e)}sendNetworkRequest({url:e,method:t,headers:n,body:r,followRedirects:o,timeout:s}){return this.actionsController.networkDelegate.sendNetworkRequest(e,t,n,r,o,s)}notifySizeChanged({height:e}){return this.actionsController.sizeChangeDelegate.notifyHeightChange(e)}sendMerchantEvent({name:e,payload:t}){return this.actionsController.merchantMessageDelegate.sendMerchantEvent(e,t)}sendMerchantError({name:e,payload:t,fatal:n}){return this.actionsController.merchantMessageDelegate.sendMerchantError(e,t,n)}getData({key:e}){return this.actionsController.dataStoreDelegate.getData(e)}putData({key:e,value:t}){return this.actionsController.dataStoreDelegate.putData(e,t)}testExternalApp({url:e}){return this.actionsController.externalAppDelegate.testExternalApp(e)}openExternalApp({url:e}){return this.actionsController.externalAppDelegate.openExternalApp(e)}openExternalBrowser({url:e}){return this.actionsController.externalBrowserDelegate.openExternalBrowser(e)}showInternalBrowser({url:e,hideOnUrls:t}){return this.actionsController.internalBrowserDelegate.showInternalBrowser(e,t)}hideInternalBrowser(){return this.actionsController.internalBrowserDelegate.hideInternalBrowser()}showSandboxBrowser({url:e}){return this.actionsController.sandboxBrowserDelegate.showSandboxBrowser(e)}focusScroll({top:e,left:t,width:n,height:r,animated:o}){return this.actionsController.scrollDelegate.focusScroll(e,t,n,r,o)}launchFullscreen({shouldScrollToTop:e,animated:t}){return this.actionsController.movingFullscreenDelegate.showMovingFullscreen(e,t)}exitFullscreen(){return this.actionsController.movingFullscreenDelegate.hideMovingFullscreen()}loadSeparateFullscreenUrl({url:e}){return this.actionsController.separateFullscreenDelegate.loadFullscreenUrl(e)}showSeparateFullscreen({placement:e,initialHeight:t,background:n,canScroll:r,canDismiss:o,hideOnUrls:s}){return this.actionsController.separateFullscreenDelegate.showFullscreen(null!=e?e:ke.full,t,n,r,o,s)}hideSeparateFullscreen(){return this.actionsController.separateFullscreenDelegate.hideFullscreen()}shareFile({dataUri:e,fileName:t}){return this.actionsController.contentSharingDelegate.shareFile(e,t)}startAuthentication({url:e}){return this.actionsController.authenticationBrowserDelegate.showAuthenticationBrowser(e)}actionToNative({actionType:e,params:t,messageId:n}){return this.actionsController.nativeActionDelegate.actionToNative(e,t,n)}actionToComponent({component:e,actionType:t,params:n,messageId:r}){return this.actionsController.componentActionDelegate.actionToComponent(e,t,n,r)}constructor(e){this.component=e.component,this.componentVersion=e.componentVersion,this.bridgeController=new E,this.receiverController=new he,this.messageController=new O(e.component,this.bridgeController,this.receiverController),this.actionsController=new ue(this.messageController)}}(ve=Pe||(Pe={})).available="available",ve.uncertain="uncertain",ve.unavailable="unavailable",(ye=Ae||(Ae={})).darken="darken",ye.transparent="transparent",(we=Ee||(Ee={})).off="off",we.error="error",we.verbose="verbose",(be=Ie||(Ie={})).debug="debug",be.error="error";var ge,fe,me,ve,ye,we,be,Se,Ce,ke,Pe,Ae,Ee,Ie,Me,Re=function(){function e(e){this.mobileSdkMessaging=e}return e.prototype.onAction=function(e,t){this.mobileSdkMessaging.onAction({action:e,callback:t})},e.prototype.handshake=function(){return this.mobileSdkMessaging.handshake()},e.prototype.actionToNative=function(e,t,n){void 0===n&&(n=void 0),this.mobileSdkMessaging.actionToNative({actionType:e,params:t,messageId:n})},e.prototype.loadSeparateFullscreenUrl=function(e){this.mobileSdkMessaging.loadSeparateFullscreenUrl({url:e})},e.prototype.showSeparateFullscreen=function(){return this.mobileSdkMessaging.showSeparateFullscreen({placement:ke.full})},e.prototype.hideSeparateFullscreen=function(){return this.mobileSdkMessaging.hideSeparateFullscreen()},e.prototype.logComponentStatus=function(e){var t={component:l,status:e};this.mobileSdkMessaging.sendComponentStatus({params:t})},e.prototype.logComponentEvent=function(e){var t={component:l,event:e};this.mobileSdkMessaging.sendComponentStatus({params:t})},e}(),Ne=function(){function e(e,t){this.paymentsController=t,this.mobileSdkMessagingController=e}return e.prototype.canProcessMessage=function(e){return"paymentRequest"===e||"paymentPrepare"===e||"paymentInitiate"===e||"paymentUpdate"===e||"paymentFetch"===e||"paymentCancel"===e||"paymentShippingAddressChangeResponse"===e||"paymentShippingOptionSelectResponse"===e},e.prototype.processMessage=function(e){switch(e.params.actionType){case"paymentRequest":this.performPaymentRequest(e);break;case"paymentPrepare":this.performPaymentPrepare(e);break;case"paymentFetch":this.performPaymentRequestFetch(e);break;case"paymentInitiate":this.performPaymentInitiate(e);break;case"paymentUpdate":this.performPaymentUpdate(e);break;case"paymentCancel":this.performPaymentCancel(e);break;case"paymentShippingAddressChangeResponse":this.performShippingAddressChange(e);break;case"paymentShippingOptionSelectResponse":this.performShippingOptionSelect(e)}},e.prototype.createPaymentRequestConfig=function(e){return this.createPaymentRequestData(e)||e.params.paymentRequestId},e.prototype.createPaymentRequestData=function(e){try{var t=e.params.paymentRequestData;return t?JSON.parse(t):void 0}catch(e){return void o.default.error("Failed parsing the payment request data: ".concat(e))}},e.prototype.performPaymentRequest=function(e){var t=e.messageId,n=this.createPaymentRequestConfig(e);try{this.paymentsController.setOnStateUpdateCallback(this.mobileSdkMessagingController),this.paymentsController.observeShippingEvents(this.mobileSdkMessagingController);var r=this.paymentsController.request(n);this.mobileSdkMessagingController.actionToNative("paymentRequest",new c(r).toParams(),t)}catch(e){var o="Failed creating the payment request: ".concat(e);this.sendErrorToNative("paymentRequest",t,o,!0,e)}},e.prototype.performPaymentPrepare=function(e){var t=this,n=e.messageId;this.paymentsController.prepare().then((function(){t.mobileSdkMessagingController.actionToNative("paymentPrepare",{},n)})).catch((function(e){var r="Failed preparing the payment request: ".concat(e instanceof Error?e.message:e.errorMessage);t.sendErrorToNative("paymentPrepare",n,r,!0,e)}))},e.prototype.performPaymentInitiate=function(e){var t=this,n=e.messageId;this.paymentsController.initiate(this.mobileSdkMessagingController).then((function(){t.mobileSdkMessagingController.actionToNative("paymentInitiate",{},n)})).catch((function(e){var r="Failed initiating the payment request: ".concat(e instanceof Error?e.message:e.errorMessage);t.sendErrorToNative("paymentInitiate",n,r,!0,e)}))},e.prototype.performPaymentRequestFetch=function(e){var t=this,n=e.messageId;this.paymentsController.fetch().then((function(e){t.mobileSdkMessagingController.actionToNative("paymentFetch",new c(e).toParams(),n)})).catch((function(e){var r="Failed fetching the payment request: ".concat(e.errorMessage);t.sendErrorToNative("paymentFetch",n,r,!0,e)}))},e.prototype.performPaymentUpdate=function(e){var t=this,n=e.messageId,r=this.createPaymentRequestData(e);r?this.paymentsController.update(r).then((function(){t.mobileSdkMessagingController.actionToNative("paymentUpdate",{},n)})).catch((function(e){var r="Failed updating the payment request: ".concat(e.errorMessage);t.sendErrorToNative("paymentUpdate",n,r,!0,e)})):this.sendErrorToNative("paymentUpdate",n,"Failed updating the payment request: Payment request data is invalid or missing",!0,void 0)},e.prototype.performPaymentCancel=function(e){var t=this,n=e.messageId;this.paymentsController.cancel().then((function(){t.mobileSdkMessagingController.actionToNative("paymentCancel",{},n)})).catch((function(e){var r="Failed canceling the payment request: ".concat(e.errorMessage);t.sendErrorToNative("paymentCancel",n,r,!0,e)}))},e.prototype.performShippingAddressChange=function(e){try{var t=this.createShippingAddressChange(e);this.paymentsController.changeShippingAddress(e.messageId,t)}catch(t){this.sendErrorToNative("paymentShippingAddressChangeResponse",e.messageId,"Failed changing the shipping address. ".concat(t),!1,t)}},e.prototype.createShippingAddressChange=function(e){var t=e.params.paymentShippingAddressChange;return JSON.parse(t)},e.prototype.performShippingOptionSelect=function(e){try{var t=this.createShippingOptionSelect(e);this.paymentsController.selectShippingOption(e.messageId,t)}catch(t){this.sendErrorToNative("paymentShippingOptionSelectResponse",e.messageId,"Failed selecting the shipping option. ".concat(t),!1,t)}},e.prototype.createShippingOptionSelect=function(e){var t=e.params.paymentShippingOptionSelect;return JSON.parse(t)},e.prototype.sendErrorToNative=function(e,t,n,r,s){o.default.error(n),this.mobileSdkMessagingController.actionToNative(e,new f(n,r,s instanceof Error?void 0:s).toParams(),t)},e}();!function(e){e[e.AsString=0]="AsString",e[e.AsBoolean=1]="AsBoolean",e[e.AsNumber=2]="AsNumber"}(Me||(Me={}));var Oe,xe,Te=function(){function e(){}return e.validateRequiredParam=function(e,t,n,r){if(void 0===e[t]||null==e[t])return r;var o=e[t];switch(n){case Me.AsBoolean:return"true"===(o=o.toLowerCase())||"false"===o;case Me.AsString:return o.length>0;case Me.AsNumber:return!isNaN(Number(o))}},e}(),De=function(){function e(e,t){this.messagingController=t,this.mobileSdkMessagingController=e}return e.prototype.canProcessMessage=function(e){return"messagingPlacement"===e||"messagingPlacementRender"===e},e.prototype.processMessage=function(e){var t=e.params.actionType;"messagingPlacement"===t?this.performMessagingPlacement(e):"messagingPlacementRender"===t&&this.performMessagingPlacementMount(e)},e.prototype.performMessagingPlacement=function(e){var t=this,n=this.createPlacementOptions(e);n&&this.messagingController.placement(n,(function(n){if(!n){var r="Messaging placement failed.",s=e.messageId;o.default.error(r),t.mobileSdkMessagingController.actionToNative("messagingPlacement",new g(r,!0).toParams(),s)}}))},e.prototype.createPlacementOptions=function(e){if(!Te.validateRequiredParam(e.params,"key",Me.AsString,!1)){var t="Param '".concat("key","' should be a non-empty string.");o.default.error(t);var n=e.messageId;return this.mobileSdkMessagingController.actionToNative("messagingPlacement",new g(t,!0).toParams(),n),null}return Te.validateRequiredParam(e.params,"locale",Me.AsString,!1)?{key:e.params.key,locale:e.params.locale}:(t="Param '".concat("locale","' should be a non-empty string."),o.default.error(t),n=e.messageId,this.mobileSdkMessagingController.actionToNative("messagingPlacement",new g(t,!0).toParams(),n),null)},e.prototype.performMessagingPlacementMount=function(e){var t=this,n=this.getPlacementContainer(e);n&&this.messagingController.mount(n,(function(n){if(!n){var r="Messaging placement render failed.";o.default.error(r);var s=e.messageId;t.mobileSdkMessagingController.actionToNative("messagingPlacementRender",new g(r,!0).toParams(),s)}}))},e.prototype.getPlacementContainer=function(e){if(!Te.validateRequiredParam(e.params,"container",Me.AsString,!1)){var t="Param '".concat("container","' should be a non-empty string.");o.default.error(t);var n=e.messageId;return this.mobileSdkMessagingController.actionToNative("messagingPlacementRender",new g(t,!0).toParams(),n),null}return e.params.container},e}(),Fe=function(){function e(e){this.pendingMessages=[],this.webSdkController=e;var t=de.init({component:l,componentVersion:"v1.0.9-2d8c7efc9c4"});this.messagingController=new Re(t),this.klarnaPaymentMessageDelegate=new Ne(this.messagingController,e.klarnaPaymentController),this.klarnaMessagingMessageDelegate=new De(this.messagingController,e.klarnaMessagingController)}return e.prototype.processPendingMessages=function(){var e=this,t=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,s=t.length;o<s;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([],this.pendingMessages,!0);this.pendingMessages.length=0;for(var n=0,r=t;n<r.length;n++){var o=r[n];null!=o&&this.processMessage(o)}this.pendingMessages.length>0&&setTimeout((function(){return e.processPendingMessages()}),0)},e.prototype.initialize=function(){return function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))}(this,void 0,void 0,(function(){var e=this;return function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,(function(t){switch(t.label){case 0:return this.messagingController.onAction("actionToComponent",(function(t){e.webSdkController.webSdkInitialized?e.processMessage(t):e.pendingMessages.push(t)})),[4,this.messagingController.handshake().then((function(){o.default.debug("Handshake was successful.")})).catch((function(e){o.default.error("Error doing handshake. ".concat(e))}))];case 1:return t.sent(),[2]}}))}))},e.prototype.processMessage=function(e){var t=e.params.actionType,n=e.messageId;if(this.klarnaPaymentMessageDelegate.canProcessMessage(t))this.klarnaPaymentMessageDelegate.processMessage(e);else if(this.klarnaMessagingMessageDelegate.canProcessMessage(t))this.klarnaMessagingMessageDelegate.processMessage(e);else{var r="Received an unrecognized action: ".concat(t);o.default.error(r),this.messagingController.actionToNative("",new g(r,!1).toParams(),n)}},e}(),Be=function(){function e(e){this.webSdkController=new S(e),this.mobileSdkController=new Fe(this.webSdkController)}return e.prototype.initialize=function(e){return function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))}(this,void 0,void 0,(function(){var t;return function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.webSdkController.initializeWebSdk(e)];case 1:return n.sent(),o.default.debug("Web SDK initialized."),this.mobileSdkController.processPendingMessages(),[3,3];case 2:return t=n.sent(),o.default.error(t),t instanceof g&&this.mobileSdkController.messagingController.actionToNative("wrapperFailure",t.toParams(),void 0),[3,3];case 3:return[2]}}))}))},e}(),Ue=function(){function e(){this.klarnaWebSdkScriptId="WebSdkScript"}return Object.defineProperty(e.prototype,"isWebSDKAdded",{get:function(){return null!=document.getElementById(this.klarnaWebSdkScriptId)},enumerable:!1,configurable:!0}),e.prototype.load=function(e,t,n,r){if(o.default.debug("Adding ".concat(i," to the page...")),this.isWebSDKAdded)n();else{var s=this.createWebSdkScriptElement(e,t,n,r);document.head.appendChild(s)}},e.prototype.createWebSdkScriptElement=function(e,t,n,r){var o=document.createElement("script");return o.id=this.klarnaWebSdkScriptId,o.src=this.constructFinalUrl(e,t,s),o.async=!1,this.setEventListeners(o,n,r),o},e.prototype.constructFinalUrl=function(e,t,n){void 0===n&&(n=s);var r=e||n;return r=this.ensureKlarnaJsUrl(r),t&&t.trim()&&(r=this.replaceVersionInUrl(r,t)),r},e.prototype.ensureKlarnaJsUrl=function(e){return e.endsWith("/".concat(a))?e:e.endsWith("/")?"".concat(e).concat(a):"".concat(e,"/").concat(a)},e.prototype.replaceVersionInUrl=function(e,t){var n=/(v\d+(\.\d+)*)/;return n.test(e)?e.replace(n,"".concat(t)):e.replace("/".concat(a),"/".concat(t,"/").concat(a))},e.prototype.setEventListeners=function(e,t,n){e.addEventListener("load",(function(){o.default.debug("".concat(i," added to the page: ").concat(e.src)),t()})),e.addEventListener("error",(function(){n(new g("Error adding ".concat(i," to the page from ").concat(e.src,"."),!1))}))},e}();!function(e){e.ready="ready",e.loaded="loaded"}(Oe||(Oe={})),function(e){e.loadWebSdkScriptCompleted="loadWebSdkScriptCompleted",e.loadWebSdkScriptFailed="loadWebSdkScriptFailed"}(xe||(xe={}));var We=function(){return We=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},We.apply(this,arguments)},_e=function(){function t(e,t){void 0===e&&(e=new Ue),void 0===t&&(t=new Be(e)),this.webSdkLoader=e,this.wrapperController=t}return t.prototype.initialize=function(e){var t=this,n=this.parseQueryParams(e);this.setLogLevel(n),this.setOrigin(n),this.wrapperController.mobileSdkController.initialize().then((function(){t.loadWebSDK(n,(function(){t.logComponentEvent(xe.loadWebSdkScriptCompleted),t.logComponentStatus(Oe.ready)}),(function(e){o.default.error(e),t.logComponentEvent(xe.loadWebSdkScriptFailed),t.wrapperController.mobileSdkController.messagingController.actionToNative("wrapperFailure",e.toParams(),void 0),t.wrapperController.mobileSdkController.processPendingMessages()}))})).catch((function(e){o.default.error("Error initializing Mobile SDK. ".concat(e))}))},t.prototype.loadWebSDK=function(e,t,n){this.webSdkLoader.load(e.webSdkUrl,e.webSdkVersion,t,n)},t.prototype.parseQueryParams=function(t){return{logLevel:t.getNumber("logLevel",e.None),webSdkVersion:t.getString("webSdkVersion"),webSdkUrl:t.getString("webSdkUrl"),origin:t.getString("origin"),accountId:t.getString("accountId"),additionalIdentifier:t.getString("additionalIdentifier"),clientId:t.getString("clientId"),clientInstanceName:t.getString("clientInstanceName"),locale:t.getString("locale"),shoppingSessionId:t.getString("shoppingSessionId")}},t.prototype.setLogLevel=function(t){var n;o.default.level=null!==(n=t.logLevel)&&void 0!==n?n:e.None},t.prototype.setOrigin=function(e){e.origin&&(window.klarnaMobileSDKOrigin=e.origin)},t.prototype.initializeWebSDK=function(e){return function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))}(this,void 0,void 0,(function(){var t,n;return function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,(function(r){switch(r.label){case 0:return t=this.parseQueryParams(e),(n=this.createWebSDKConfiguration(t))instanceof g?(o.default.error("Failed to initialize Web SDK. Error: ".concat(n)),this.wrapperController.mobileSdkController.messagingController.actionToNative("wrapperFailure",n.toParams(),void 0),[2]):[4,this.wrapperController.initialize(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.logComponentStatus=function(e){this.wrapperController.mobileSdkController.messagingController.logComponentStatus(e)},t.prototype.logComponentEvent=function(e){this.wrapperController.mobileSdkController.messagingController.logComponentEvent(e)},t.prototype.createWebSDKConfiguration=function(e){var t=e.clientId,n=e.accountId,r=e.additionalIdentifier,o=e.clientInstanceName,s=e.locale,i=e.shoppingSessionId;return t&&0!==t.trim().length?We(We(We(We(We({clientId:t},n&&{accountId:n}),r&&{additionalIdentifier:r}),o&&{clientInstanceName:o}),s&&{locale:s}),i&&{shoppingSessionId:i}):new g("Client ID is missing or blank.",!0)},t}(),Le=new t;window.KlarnaSDKCallback=function(e){return function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function(){return function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,(function(t){switch(t.label){case 0:return window.Klarna=e,[4,window.KlarnaWebSDKWrapper.initializeWebSDK(Le)];case 1:return t.sent(),[2]}}))}))},window.onload||window.addEventListener("load",(function(){window.KlarnaWebSDKWrapper||(window.KlarnaWebSDKWrapper=new _e,window.KlarnaWebSDKWrapper.logComponentStatus(Oe.loaded),window.KlarnaWebSDKWrapper.initialize(Le))}))})()})();</script></head><body><div id="web-sdk-container"></div></body></html>